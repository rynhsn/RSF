@page "/PMT01900"

@inherits R_Page;


<R_StackLayout>
    <R_StackLayout Row>

        <R_ItemLayout col="1">
            <R_Label FontStyle="R_eFontStyle.Bold" FontColor="R_eFontColor.Danger">
                @_localizer["_PROPERTY"]
            </R_Label>

        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_ComboBox Data="@_viewModel.oPropertyList"
                        Value="@_viewModel.oPropertyId.CPROPERTY_ID"
                        ValueField="@nameof(BaseAOCResponsePropertyListDTO.CPROPERTY_ID)"
                        TextField="@nameof(BaseAOCResponsePropertyListDTO.CPROPERTY_NAME)"
                        Enabled="_viewModel.lControlButton"
                        ValueChanged="@((string value) => PropertyDropdown_OnChange(value))">
            </R_ComboBox>
        </R_ItemLayout>

    </R_StackLayout>
</R_StackLayout>

<R_TabStrip @ref="@_tabStripRef"
            OnActiveTabIndexChanged="OnActiveTabIndexChangedAsync"
            OnActiveTabIndexChanging="OnActiveTabIndexChangingAsync">

    <!-- Offer List -->
    <R_TabStripTab Title="@_localizer["_LOIList"]" Id="LOIList" Enabled="_viewModel.lControlTabLOIList">

        <!-- Filtering -->
        <R_ItemLayout col="10" Class="mb-2">
            <R_RadioGroup Data="@_viewModel.loRadioFilteringLOI"
                          Value="@_viewModel.cFilterStatusList"
                          ValueField="@nameof(BaseAOCResponseComboBoxDTO.CCODE)"
                          TextField="@nameof(BaseAOCResponseComboBoxDTO.CDESCRIPTION)"
                          ValueChanged="@((string value) => FilteringLOIList_OnChange(value))" />
        </R_ItemLayout>
        <!-- List LOI List -->
        <R_Grid @ref="@_gridLOIList"
                DataSource="_viewModel.oLOIList"
                R_ConductorGridSource="@_conductorLOIList"
                Pageable
                Height="250px"
                PageSize="10"
                R_GridType="@R_eGridType.Original"
                R_ServiceGetListRecord="@R_ServiceGetListLOIListRecordAsync"
                R_Display="@R_DisplayLOIListGetRecordAsync"
                AllowAddNewRow="false"
                AllowEditRow="false"
                AllowDeleteRow="false">
            <R_GridColumns>
                
                <R_GridTextColumn Width="195px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CDEPT_NAME)"
                                  HeaderText="@_localizer["_Department"]" />

                <R_GridTextColumn Width="195px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CEVENT_NAME)"
                                  HeaderText="@_localizer["_EventName"]" />

                <R_GridTextColumn Width="250px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CREF_NO)"
                                  HeaderText="@_localizer["_RefNo"]" />

                <R_GridDatePickerColumn FieldName="@nameof(BaseAOCResponseAgreementListDTO.DREF_DATE)"
                                        HeaderText="@_localizer["_RefDate"]"
                                        Width="225px" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CTENANT_NAME)"
                                  HeaderText="@_localizer["_ProspectorTenant"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CSALESMAN_NAME)"
                                  HeaderText="@_localizer["_Salesman"]" />

                <R_GridNumericColumn Width="150px"
                                     FieldName="@nameof(BaseAOCResponseAgreementListDTO.NBOOKING_FEE)"
                                     HeaderText="@_localizer["_BookingFee"]" />

                <R_GridCheckBoxColumn Width="150px"
                                      FieldName="@nameof(BaseAOCResponseAgreementListDTO.LPAID)"
                                      HeaderText="@_localizer["_Paid"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CTRANS_STATUS_DESCR)"
                                  HeaderText="@_localizer["_Status"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CDOC_TYPE)"
                                  HeaderText="@_localizer["_Document"]" />

                <R_GridDatePickerColumn Width="150px"
                                        FieldName="@nameof(BaseAOCResponseAgreementListDTO.DHO_ACTUAL_DATE)"
                                        HeaderText="@_localizer["_ActualHODate"]" />

                <R_GridDatePickerColumn Width="150px"
                                        FieldName="@nameof(BaseAOCResponseAgreementListDTO.DOPEN_DATE)"
                                        HeaderText="@_localizer["_OpeningDate"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementListDTO.CEVENT_NAME)"
                                  HeaderText="@_localizer["_EventName"]" />

                <R_GridTextColumn FieldName="@nameof(BaseAOCResponseAgreementListDTO.CUPDATE_BY)"
                                  HeaderText="@_localizer["_UpdatedBy"]"
                                  Width="125px" />

                <R_GridDateTimePickerColumn FieldName="@nameof(BaseAOCResponseAgreementListDTO.DUPDATE_DATE)"
                                            HeaderText="@_localizer["_UpdatedDate"]"
                                            Width="225px" />

                <R_GridTextColumn FieldName="@nameof(BaseAOCResponseAgreementListDTO.CCREATE_BY)"
                                  HeaderText="@_localizer["_CreatedBy"]"
                                  Width="125px" />

                <R_GridDateTimePickerColumn FieldName="@nameof(BaseAOCResponseAgreementListDTO.DCREATE_DATE)"
                                            HeaderText="@_localizer["_CreatedDate"]"
                                            Width="225px" />
            </R_GridColumns>
        </R_Grid>

        <!-- Name of Building -->
        <R_ItemLayout>
            <R_Label>
                @_viewModel.cBuildingSelectedUnit
            </R_Label>
        </R_ItemLayout>

        <!-- List of Unit -->
        <R_Grid @ref="@_gridUnitList"
                DataSource="_viewModel.oUnitList"
                R_ConductorGridSource="@_conductorUnitList"
                R_GridType="@R_eGridType.Original"
                R_ServiceGetListRecord="@R_ServiceGetListUnitListRecordAsync"
                Pageable
                Height="200px"
                PageSize="5"
                AllowDeleteRow="false"
                AllowAddNewRow="false"
                AllowEditRow="false">
            <R_GridColumns>
                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementUnitInfoListDTO.CFLOOR_ID)"
                                  HeaderText="@_localizer["_Floor"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementUnitInfoListDTO.COTHER_UNIT_ID)"
                                  HeaderText="@_localizer["_OtherUnitId"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementUnitInfoListDTO.COTHER_UNIT_TYPE_ID)"
                                  HeaderText="@_localizer["_OtherUnitType"]" />

                <R_GridNumericColumn Width="150px"
                                     FieldName="@nameof(BaseAOCResponseAgreementUnitInfoListDTO.NGROSS_AREA_SIZE)"
                                     HeaderText="@_localizer["_Gross"]" />

                <R_GridNumericColumn Width="150px"
                                     FieldName="@nameof(BaseAOCResponseAgreementUnitInfoListDTO.NNET_AREA_SIZE)"
                                     HeaderText="@_localizer["_Net"]" />

                <R_GridTextColumn Width="150px"
                                  FieldName="@nameof(BaseAOCResponseAgreementUnitInfoListDTO.CLOCATION)"
                                  HeaderText="@_localizer["_Location"]" />

            </R_GridColumns>

        </R_Grid>

        <!-- Button -->
        <R_StackLayout Row>

            <!-- Submit -->
            <R_ItemLayout Class="d-flex" col="4">
                <R_ItemLayout>
                    <R_Button R_ConductorGridSource="@_conductorLOIList"
                              Enabled="false"
                              OnClick="@BlankFunction">
                        @_localizer["_Print"]
                    </R_Button>
                </R_ItemLayout>

                <R_ItemLayout>
                    <R_Button R_ConductorGridSource="@_conductorLOIList"
                              Enabled="_viewModel.lControlButtonSubmit"
                              OnClick="@ProsesSubmit">
                        @_localizer["_Submit"]
                    </R_Button>
                </R_ItemLayout>

                <R_ItemLayout>
                    <R_Button R_ConductorGridSource="@_conductorLOIList"
                              Enabled="_viewModel.lControlButtonRedraft"
                              OnClick="@ProsesRedraft">
                        @_localizer["_Redraft"]
                    </R_Button>
                </R_ItemLayout>

            </R_ItemLayout>

        </R_StackLayout>

    </R_TabStripTab>

    <!-- Offer -->
    <R_TabStripTab Title="@_localizer["_LOI"]" Id="LOI" Enabled="_viewModel.lControlTabLOI">
        <R_TabPage R_Before_Open_TabPage="General_Before_Open_LOI_TabPage"
                   R_TabEventCallback="@R_TabEventCallbackAsync"
                   @ref="_tabLOI" />
    </R_TabStripTab>

    <!-- Unit -->
    <R_TabStripTab Title="@_localizer["_UnitAndCharges"]" Id="Unit" Enabled="_viewModel.lControlTabUnitandCharges">
        <R_TabPage R_Before_Open_TabPage="General_Before_Open_Unit_TabPage"
                   R_TabEventCallback="@R_TabEventCallbackAsync"
                   @ref="_tabUnit" />
    </R_TabStripTab>

    <!-- Deposit -->
    <R_TabStripTab Title="@_localizer["_Deposit"]" Id="Deposit" Enabled="_viewModel.lControlTabDeposit">
        <R_TabPage R_Before_Open_TabPage="General_Before_Open_Deposit_TabPage"
                   R_TabEventCallback="@R_TabEventCallbackAsync"
                   @ref="_tabDeposit" />
    </R_TabStripTab>

</R_TabStrip>


<R_ConductorGrid @ref="@_conductorLOIList"
                 R_IsHeader />

<R_ConductorGrid @ref="@_conductorUnitList"
                 R_ConductorParent="_conductorLOIList" />
