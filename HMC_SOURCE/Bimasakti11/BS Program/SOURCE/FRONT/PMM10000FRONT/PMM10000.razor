@page "/PMM10000"
@using Global_PMCOMMON.DTOs.Response.Property;
@using PMM10000COMMON.SLA_Category;
@using PMM10000MODEL.DTO;
@inherits R_Page
@attribute [R_Page(ResourceId = "_SLAMaster")]
@inject R_ILocalizer<Resources_PMM10000_Class> _localizer

<R_StackLayout Row>
    <R_ItemLayout col="1">
        <R_Label FontStyle="R_eFontStyle.Bold"
                 FontColor="R_eFontColor.Danger">
            @_localizer["_Property"]
        </R_Label>
    </R_ItemLayout>
    <R_ItemLayout col="3">
        <R_ComboBox Data="@_viewModel._PropertyList"
                    Value="_viewModel._PropertyValue.CPROPERTY_ID"
                    ValueField="@nameof(PropertyDTO.CPROPERTY_ID)"
                    TextField="@nameof(PropertyDTO.CPROPERTY_NAME)"
                    ValueChanged="@((string value) => PropertyDropdown_OnChange(value))">
        </R_ComboBox>
    </R_ItemLayout>
</R_StackLayout>

<R_TabStrip @ref="_tabCategory" Class="mt-1" OnActiveTabIndexChanging="@TabChanging">
    <R_TabStripTab Title="@_localizer["_TabCategroy"]" Id="TabCategory">

                <R_StackLayout Row >
            <R_ItemLayout col="4">
                <R_StackLayout Row>
                    <R_TreeView @ref="@_treeRef"
                                R_ConductorSource="@_conductorRef"
                                TextField="@nameof(PMM10000TreeDTO.Description)"
                                IdField="@nameof(PMM10000TreeDTO.Id)"
                                ParentIdField="@nameof(PMM10000TreeDTO.ParentId)"
                                HasChildrenField="@nameof(PMM10000TreeDTO.HasChildren)"
                                R_ServiceGetListRecord="@ServiceGetListRecord"
                                Height="535px"
                                Width="500px"
                                Enabled="@(!_pageOnCRUDmode)"
                                AfterAddBehaviour="R_eTreeviewAfterAddBehaviour.OnParentNode"
                                TModel="PMM10000TreeDTO"/>

                </R_StackLayout>
            </R_ItemLayout>

            <R_ItemLayout col="8" Class="ps-3 d-flex flex-column" style="height: 69vh;">
                <!-- Konten Atas -->
                <R_StackLayout Row>
                    <R_ItemLayout col="2">
                        <R_Label>@_localizer["_Level"]*</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="5">
                        <R_NumericTextBox @bind-Value="_viewModel.Data.ILEVEL"
                                          R_ConductorSource="@_conductorRef"
                                          Enabled="false">
                        </R_NumericTextBox>
                    </R_ItemLayout>
                </R_StackLayout>
                <R_StackLayout Row>
                    <R_ItemLayout col="2">
                        <R_Label>@_localizer["_CategoryId"]*</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="5">
                        <R_TextBox @ref="@CatId_textBox"
                                   @bind-Value="_viewModel.Data.CCATEGORY_ID"
                                   R_ConductorSource="@_conductorRef"
                                   MaxLength="20"
                                   R_EnableAdd>
                        </R_TextBox>
                    </R_ItemLayout>
                </R_StackLayout>
                <R_StackLayout Row>
                    <R_ItemLayout col="2">
                        <R_Label>@_localizer["_CategoryName"]*</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="5">
                        <R_TextBox @ref="@CatName_textBox"
                                   @bind-Value="_viewModel.Data.CCATEGORY_NAME"
                                   R_ConductorSource="@_conductorRef"
                                   MaxLength="100"
                                   R_EnableAdd R_EnableEdit>
                        </R_TextBox>
                    </R_ItemLayout>
                </R_StackLayout>
                <R_StackLayout Row>
                    <R_ItemLayout col="2">
                        <R_Label>@_localizer["_Notes"]</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="6">
                        <R_TextArea @bind-Value="_viewModel.Data.CNOTES"
                                    R_ConductorSource="@_conductorRef"
                                    MaxLength="255"
                                    R_EnableAdd R_EnableEdit>
                        </R_TextArea>
                    </R_ItemLayout>
                </R_StackLayout>

                  <!-- Konten Bawah -->
                <div class="mt-auto">
        <!-- _UpdateBy dan _CreateBy -->
                <R_StackLayout Row>                   
                    <R_ItemLayout col="2" >
                        <R_Label>@_localizer["_UpdateBy"]</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="2">
                        <R_TextBox @bind-Value="_viewModel.Data.CUPDATE_BY"
                                   R_ConductorSource="@_conductorRef"
                                   Enabled="false">
                        </R_TextBox>
                    </R_ItemLayout>
                    <R_ItemLayout col="4">
                        <R_DateTimePicker @bind-Value="_viewModel.Data.DUPDATE_DATE"
                                          R_ConductorSource="@_conductorRef"
                                          ShowPickerButton="false"
                                          Enabled="false">
                        </R_DateTimePicker>
                    </R_ItemLayout>
                </R_StackLayout>
                <R_StackLayout Row>
                    <R_ItemLayout col="2">
                        <R_Label>@_localizer["_CreateBy"]</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="2">
                        <R_TextBox @bind-Value="_viewModel.Data.CCREATE_BY"
                                   R_ConductorSource="@_conductorRef"
                                   Enabled="false">
                        </R_TextBox>
                    </R_ItemLayout>
                    <R_ItemLayout col="4">
                        <R_DateTimePicker @bind-Value="_viewModel.Data.DCREATE_DATE"
                                          R_ConductorSource="@_conductorRef"
                                          ShowPickerButton="false"
                                          Enabled="false">
                        </R_DateTimePicker>
                    </R_ItemLayout>
                </R_StackLayout>
                <R_StackLayout Row Class="mt-2">
                    <R_ItemLayout col="9">
                        <R_AddButton R_Conductor="@_conductorRef"></R_AddButton>
                        <R_EditButton R_Conductor="@_conductorRef"></R_EditButton>
                        <R_DeleteButton R_Conductor="@_conductorRef" Enabled="@EnableDelete"></R_DeleteButton>
                    </R_ItemLayout>
                    <R_ItemLayout col="3">
                        <R_CancelButton R_Conductor="@_conductorRef"></R_CancelButton>
                        <R_SaveButton R_Conductor="@_conductorRef"></R_SaveButton>
                    </R_ItemLayout>
                </R_StackLayout>
                </div>
                </R_ItemLayout>

                </R_StackLayout>
    </R_TabStripTab>
    <R_TabStripTab Title="@_localizer["_TabCallType"]"
                   Id="TabCallType">
        <R_TabPage @ref="@_tabPageCallType" 
            R_Before_Open_TabPage="Before_Open_CallType"
                   R_TabEventCallback="@R_TabEventCallback">
        </R_TabPage>
    </R_TabStripTab>
        <R_TabStripTab Title="@_localizer["_TabPriceList"]"
                   Id="TabPriceList">
                <R_TabPage @ref="@_tabPagePricelist"
                   R_Before_Open_TabPage="Before_Open_Pricelist">
        </R_TabPage>
    </R_TabStripTab>
</R_TabStrip>

                <R_Conductor @ref="@_conductorRef"
             R_ViewModel="@_viewModel"
             R_IsHeader="true"
             R_ServiceGetRecord="@ServiceGetRecordAsync"
             R_Display="@R_Display"
             R_CheckEdit="@CheckEdit"
             R_AfterAdd="@AfterAdd"
             R_Validation="@Validation"
             R_ServiceDelete="@ServiceDelete"
             R_ServiceSave="@ServiceSave"
             R_BeforeCancel="@BeforeCancel"
             R_AfterDelete="@AfterDelete"
             R_SetOther="@SetOther"
             R_SetHasData="@SetHasData"
             R_ConvertToGridEntity="@ConvertToGridEntity">
                </R_Conductor>
