@inherits R_Page
@attribute [R_Page(Title = "Hand Over PopUp")]
@inject R_ILocalizer<Resources_PMT02000_Class> _localizer

<R_StackLayout Style="width: 1300px">

    <R_StackLayout>
        <R_ItemLayout col="6">
            <h3 class="mb-0">@_viewModel._oParamHeaderPopUp.CPROPERTY_NAME</h3>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout col="8">
            <h5 class="mb-0">@_viewModel._oParamHeaderPopUp.CBUILDING_NAME</h5>
        </R_ItemLayout>
        <R_ItemLayout col="4">
            <h5 class="mb-0">@_viewModel._oParamHeaderPopUp.CDEPT_NAME</h5>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout col="8">
            <h5 class="mb-0">@_viewModel._oParamHeaderPopUp.CUNIT_DESCRIPTION</h5>
        </R_ItemLayout>
        <R_ItemLayout col="4">
            <h5 class="mb-0">
                <R_Label>@_localizer[@labelHO_LOIRefNo]: </R_Label>
                @_viewModel._oParamHeaderPopUp.CREF_NO</h5>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout col="8">
            <h5 class="mb-0">@_viewModel._oParamHeaderPopUp.CTENANT_NAME</h5>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row Class="mt-3">

        <R_ItemLayout col="5">
            <R_StackLayout Row>
                <R_ItemLayout col="5">
                    <R_Label>@_localizer["_HORefNo"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_TextBox @bind-Value="@_viewModel.Data.CHO_REF_NO"
                               @ref="@FocusLabelRefNo"
                               R_ConductorSource="_conConductorHeader"
                               MaxLength="30"
                               R_EnableAdd
                               Enabled="@(_lAdd_Mode && _lDataCREF_NO)">
                    </R_TextBox>
                    </R_ItemLayout>
                    </R_StackLayout>
                    </R_ItemLayout>

                    <R_ItemLayout col="4">
                    <R_StackLayout Row>
                <R_ItemLayout col="5">
                    <R_Label>@_localizer["_HORefDate"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_DatePicker @bind-Value="@_viewModel.Data.DHO_REF_DATE"
                                  R_ConductorSource="_conConductorHeader"
                                    R_EnableAdd>
                    </R_DatePicker>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="5">
            <R_StackLayout Row>
                <R_ItemLayout col="5">
                    <R_Label>@_localizer["_HOPlanDate"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_DatePicker @bind-Value="@_viewModel.Data.DHAND_OVER_DATE"
                                  R_ConductorSource="_conConductorHeader"
                                  Enabled="false">
                    </R_DatePicker>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

        <R_ItemLayout col="4">
            <R_StackLayout Row>
                <R_ItemLayout col="5">
                    <R_Label>@_localizer["_HOActualDate"]*</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_DatePicker @bind-Value="@_viewModel.Data.DHO_ACTUAL_DATE"
                                  R_ConductorSource="_conConductorHeader"
                                    R_EnableAdd
                                    R_EnableEdit>
                    </R_DatePicker>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>


    </R_StackLayout>


    <R_StackLayout Row>
        <R_ItemLayout col="5">
            <R_StackLayout Row>
                <R_ItemLayout col="5">
                    <R_Label>@_localizer["_PlanStartDate"]*</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_DatePicker @bind-Value="@_viewModel.Data.DHO_PLAN_START_DATE"
                                  R_ConductorSource="_conConductorHeader"
                                  Enabled="false">
                    </R_DatePicker>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

        <R_ItemLayout col="4">
            <R_StackLayout Row>
                <R_ItemLayout col="5">
                    <R_Label>@_localizer["_PlanEndDate"]*</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_DatePicker @bind-Value="@_viewModel.Data.DHO_PLAN_END_DATE"
                                  R_ConductorSource="_conConductorHeader"
                                  Enabled="false">
                    </R_DatePicker>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_ItemLayout col="9">

            <R_Grid @ref="@_griLOIDetailRefUnit"
                    DataSource="_viewModel._listDetailUnit"
                    R_ConductorGridSource="@_conGridUnit"
                    @bind-PageSize="@_pageSizeUnit"
                    R_GridType="@R_eGridType.Batch"
                    R_ServiceGetListRecord="@R_ServiceLOIUnitListRecord"
                    R_Display="@Grid_DisplayUnit"
                    R_ServiceGetRecord="@R_ServiceGetRecordUnit"
                     R_Validation="@ValidationUnit"
                    Pageable="true"
                    AllowDeleteRow="false"
                    AllowAddNewRow="false"
                    AllowEditRow="@_cekEdit"
                    Height="140px">
                <R_GridColumns>
                    <R_GridTextColumn Width="40px"
                                      FieldName="@nameof(PMT02000LOIHandOverUnitDTO.CFLOOR_ID)"
                                      HeaderText=@_localizer["_Floor"] />
                    <R_GridTextColumn Width="40px"
                                      FieldName="@nameof(PMT02000LOIHandOverUnitDTO.CUNIT_ID)"
                                      HeaderText=@_localizer["_Unit"] />
                    <R_GridNumericColumn Width="50px"
                                         FieldName="@nameof(PMT02000LOIHandOverUnitDTO.NGROSS_SIZE)"
                                         HeaderText=@_localizer["_GrossSize"]
                                         Enabled="false"
                                         TValue="decimal"/>
                    <R_GridNumericColumn Width="50px"
                                         FieldName="@nameof(PMT02000LOIHandOverUnitDTO.NNET_SIZE)"
                                         HeaderText=@_localizer["_NetSize"]
                                         Enabled="false"
                                         TValue="decimal"/>
                    <R_GridNumericColumn Width="50px"
                                         FieldName="@nameof(PMT02000LOIHandOverUnitDTO.NACTUAL_AREA_SIZE)"
                                         HeaderText=@_localizer["_ActualSize"]
                                         TValue="decimal"
                                         Min="0"
                                         R_EnableEdit="true" />
                </R_GridColumns>
            </R_Grid>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_Grid @ref="@_griLOIDetailUtilityRef"
                DataSource="_viewModel._listDetailUtilityFiltered"
                R_ConductorGridSource="@_conGridUtility"
                @bind-PageSize="@_pageSize"
                R_GridType="@R_eGridType.Batch"
                R_ServiceGetListRecord="@R_ServiceUtilityList"
                R_Display="@Grid_DisplayUtility"
                R_Validation="@ValidationUtility"
                R_ServiceGetRecord="@R_ServiceGetRecordUtility"
                Pageable="true"
                AllowDeleteRow="false"
                AllowAddNewRow="false"
                AllowEditRow="@_cekEdit"
                Height="170px">
            <R_GridColumns>
                <R_GridTextColumn Width="135px"
                                  FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.CCHARGES_TYPE_NAME)"
                                  HeaderText=@_localizer["_UtilityType"] />
                <R_GridTextColumn Width="115px"
                                  FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.CMETER_NO)"
                                  HeaderText=@_localizer["_MeterNo"] />
                <R_GridNumericColumn Width="110px"
                                     FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.NCAPACITY)"
                                     TValue="decimal"
                                     HeaderText=@_localizer["_Capacity"] />
                <R_GridNumericColumn Width="80px"
                                     FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.NCALCULATION_FACTOR)"
                                     TValue="decimal"
                                     HeaderText=@_localizer["_CF"] />
                <R_GridTextColumn Width="140px"
                                  FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.CCHARGES_NAME)"
                                  HeaderText=@_localizer["_Charge"] />
                <R_GridNumericColumn Width="115px"
                                     FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.IYEAR)"
                                     TValue="int"
                                     HeaderText=@_localizer["_StartYear"]
                                     ThousandSeparator="false"
                                                  R_EnableEdit />
                <R_GridComboBoxColumn Width="135px" Data="@_viewModel.GetMonthList"
                                      FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.CMONTH)"
                                      ValueField="@nameof(PMT02000GetMonthDTO.Id)"
                                      TextField="@nameof(PMT02000GetMonthDTO.Name)"
                                      HeaderText=@_localizer["_StartMonth"]
                                      R_EnableEdit="true"
                                      PopupMaxHeight="120px" />

                <R_GridNumericColumn Width="135px"
                                     FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.NMETER_START)"
                                     HeaderText=@_localizer["_MeterStart"]
                                     R_EnableAdd="@_viewModel.lEnableMeter"
                                     R_EnableEdit="@_viewModel.lEnableMeter"
                                     TValue="decimal"
                                     Min="0" />
                <R_GridNumericColumn Width="135px"
                                     FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.NBLOCK1_START)"
                                     HeaderText=@_localizer["_Block1Start"]
                                     R_EnableAdd="@_viewModel.lEnableIBlock"
                                     R_EnableEdit="@_viewModel.lEnableIBlock"
                                     TValue="decimal"
                                     Min="0" />
                <R_GridNumericColumn Width="135px"
                                     FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.NBLOCK2_START)"
                                     HeaderText=@_localizer["_Block2Start"]
                                     R_EnableAdd="@_viewModel.lEnableIBlock"
                                     R_EnableEdit="@_viewModel.lEnableIBlock"
                                     TValue="decimal"
                                     Min="0" />
                <R_GridTextColumn Width="140px"
                                  FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.CUPDATE_BY)"
                                  HeaderText=@_localizer["_UpdBy"] />
                <R_GridDateTimePickerColumn Width="190px"
                                            FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.DUPDATE_DATE)"
                                            HeaderText=@_localizer["_UpdDate"] />
                <R_GridTextColumn Width="140px"
                                  FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.CCREATE_BY)"
                                  HeaderText=@_localizer["_CreatedBy"] />
                <R_GridDateTimePickerColumn Width="190px"
                                            FieldName="@nameof(PMT02000LOIHandoverUtilityDTO.DUPDATE_DATE)"
                                            HeaderText=@_localizer["_CreatedDate"] />
            </R_GridColumns>
        </R_Grid>
    </R_StackLayout>
    @* Button CRUD *@


    <R_StackLayout Row Class="d-flex justify-content-end">
        <R_StackLayout Row>
            <R_ItemLayout>
                <R_Button OnClick="OnCancel"> @_localizer["_Cancel"] </R_Button>
            </R_ItemLayout>
            <R_ItemLayout>
                <R_SaveButton R_Conductor="@_conConductorHeader" />
            </R_ItemLayout>
        </R_StackLayout>
    </R_StackLayout>
</R_StackLayout>

<R_ConductorGrid @ref="@_conGridUnit"
                 R_ConductorParent="_conConductorHeader" />

<R_ConductorGrid @ref="@_conGridUtility"
                 R_ConductorParent="_conGridUnit" />

<R_Conductor @ref="_conConductorHeader"
              R_IsHeader
             R_ViewModel="_viewModel"
             R_ServiceSave="@ServiceSaveAllData"
             R_AfterSave="@AfterSave"
             R_AfterAdd="@AfterAdd"
             R_ServiceGetRecord="@ServiceGetRecord"
             R_Validation="@ValidationHeader"
             R_SetEdit="R_SetEdit"
             R_SetAdd="R_SetAdd" />
