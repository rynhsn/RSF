@page "/PMR00460"
@using PMR00460Common.DTOs
@using PMR00460FrontResources
@using R_BlazorFrontEnd.Controls.DataControls
@inherits R_Page
@inject R_ILocalizer<Resources_Dummy_Class> _localizer

<R_StackLayout Row Class="mb-1">
    <R_ItemLayout Class="me-1">
        <R_Label>@_localizer["Property"]</R_Label>
    </R_ItemLayout>
    <R_ItemLayout col="3">
        <R_ComboBox @ref="_comboPropertyRef"
                    Data="@_viewModel.PropertyList"
                    Value="@_viewModel.ReportParam.CPROPERTY_ID"
                    ValueField="@nameof(PMR00460PropertyDTO.CPROPERTY_ID)"
                    TextField="@nameof(PMR00460PropertyDTO.CPROPERTY_NAME)"
                    Enabled
                    ValueChanged="@((string value) => ValueChangedProperty(value))"/>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Class="mb-1">
    <R_ItemLayout>
        <R_GroupBox Title="@_localizer["Building"]" ShowBorder Class="p-3" Enabled="@(_viewModel.EnableView)">
            <R_StackLayout>
                <R_ItemLayout col="6" Class="ms-4">
                    <R_StackLayout Row>
                        <R_ItemLayout col="2">
                            <R_Label>@_localizer["From"]</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout col="4">
                            <R_TextBox @bind-Value="_viewModel.ReportParam.CFROM_BUILDING_ID" OnLostFocus="OnLostFocusFromBuilding" Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Lookup R_Before_Open_Lookup="BeforeLookupFromBuilding" R_After_Open_Lookup="AfterLookupFromBuilding" Enabled>...</R_Lookup>
                        </R_ItemLayout>
                        <R_ItemLayout col="5">
                            <R_TextBox @bind-Value="_viewModel.ReportParam.CFROM_BUILDING_NAME" Enabled="false"/>
                        </R_ItemLayout>
                    </R_StackLayout>
                    <R_StackLayout Row>
                        <R_ItemLayout col="2">
                            <R_Label>@_localizer["To"]</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout col="4">
                            <R_TextBox @bind-Value="_viewModel.ReportParam.CTO_BUILDING_ID" OnLostFocus="OnLostFocusToBuilding" Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Lookup R_Before_Open_Lookup="BeforeLookupToBuilding" R_After_Open_Lookup="AfterLookupToBuilding" Enabled>...</R_Lookup>
                        </R_ItemLayout>
                        <R_ItemLayout col="5">
                            <R_TextBox @bind-Value="_viewModel.ReportParam.CTO_BUILDING_NAME" Enabled="false"/>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
            </R_StackLayout>
        </R_GroupBox>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Row Class="mb-1">
    <R_ItemLayout col="7">
        <R_GroupBox Title="@_localizer["Period"]" ShowBorder Class="p-3" Enabled="@(_viewModel.EnableView)">
            <R_StackLayout>
                <R_ItemLayout Class="ms-4">
                    <R_StackLayout Row>
                        <R_ItemLayout col="2">
                            <R_Label>@_localizer["From"]</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout col="2">
                            <R_NumericTextBox @bind-Value="@_viewModel.ReportParam.IFROM_PERIOD_YEAR"
                                              Arrows
                                              Step="1"
                                              Min="@_viewModel.YearRange.IMIN_YEAR"
                                              Max="@_viewModel.YearRange.IMAX_YEAR"
                                              ThousandSeparator="false"
                                              Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout col="4">
                            <R_ComboBox Data="_viewModel.PeriodList"
                                        Value="_viewModel.ReportParam.CFROM_PERIOD_MONTH"
                                        TextField="Value"
                                        ValueField="Key"
                                        ValueChanged="@((string value) => ValueChangedFromPeriodMonth(value))"
                                        Enabled/>
                        </R_ItemLayout>
                    </R_StackLayout>
                    <R_StackLayout Row>
                        <R_ItemLayout col="2">
                            <R_Label>@_localizer["To"]</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout col="2">
                            <R_NumericTextBox @bind-Value="@_viewModel.ReportParam.ITO_PERIOD_YEAR"
                                              Arrows
                                              Step="1"
                                              Min="@_viewModel.YearRange.IMIN_YEAR"
                                              Max="@_viewModel.YearRange.IMAX_YEAR"
                                              ThousandSeparator="false"
                                              Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout col="4">
                            <R_ComboBox Data="_viewModel.PeriodList"
                                        Value="_viewModel.ReportParam.CTO_PERIOD_MONTH"
                                        TextField="Value"
                                        ValueField="Key"
                                        ValueChanged="@((string value) => ValueChangedToPeriodMonth(value))"
                                        Enabled/>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>

            </R_StackLayout>
        </R_GroupBox>
    </R_ItemLayout>
    <R_ItemLayout col="5" Class="pe-1">
        <R_GroupBox Title="@_localizer["Type"]" Class="p-3" Enabled="@(_viewModel.EnableView)">
            <R_StackLayout>
                <R_ItemLayout Class="ms-4">
                    <R_StackLayout Row>
                        <R_ItemLayout col="3">
                            <R_Label>@_localizer["Report"]</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout Class="ms-4">
                            <R_RadioGroup Data="@_viewModel.ReportType"
                                          @bind-Value="_viewModel.ReportParam.CREPORT_TYPE"
                                          ValueField="Key"
                                          TextField="Value"
                                          Layout="R_eRadioGroupLayout.Horizontal"
                                          Enabled/>
                        </R_ItemLayout>
                    </R_StackLayout>
                    <R_StackLayout Row>
                        <R_ItemLayout col="3">
                            <R_Label>@_localizer["Agreement"]</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout Class="ms-4">
                            <R_RadioGroup Data="@_viewModel.AgreementType"
                                          @bind-Value="_viewModel.ReportParam.CTYPE"
                                          ValueField="Key"
                                          TextField="Value"
                                          Layout="R_eRadioGroupLayout.Horizontal"
                                          Enabled/>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
            </R_StackLayout>
        </R_GroupBox>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout>
    <R_ItemLayout>
        <R_GroupBox Title="@_localizer["Status"]" ShowBorder Class="p-3" Enabled="@(_viewModel.EnableView)">
            <R_StackLayout Row Class="ms-4">
                <R_ItemLayout col="3">
                    <R_StackLayout Row>
                        <R_ItemLayout>
                            <R_CheckBox @bind-Value="_viewModel.ReportParam.LOPEN" Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Label>@_localizer["Open"]</R_Label>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_StackLayout Row>
                        <R_ItemLayout>
                            <R_CheckBox @bind-Value="_viewModel.ReportParam.LSCHEDULED" Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Label>@_localizer["Scheduled"]</R_Label>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_StackLayout Row>
                        <R_ItemLayout>
                            <R_CheckBox @bind-Value="_viewModel.ReportParam.LCONFIRMED" Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Label>@_localizer["Confirmed"]</R_Label>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_StackLayout Row>
                        <R_ItemLayout>
                            <R_CheckBox @bind-Value="_viewModel.ReportParam.LCLOSED" Enabled/>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Label>@_localizer["Closed"]</R_Label>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
            </R_StackLayout>
        </R_GroupBox>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Class="border-top my-3"/>

<R_StackLayout Row>
    <R_ItemLayout>
        <R_PrintButton OnClick="OnClickPrint" Enabled="@(_viewModel.EnableView)">@_localizer["Print"]</R_PrintButton>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Popup R_Before_Open_Popup="BeforeOpenPopupSaveAs" Enabled="@(_viewModel.EnableView)">@_localizer["SaveAs"]</R_Popup>
    </R_ItemLayout>
</R_StackLayout>