@page "/PMT00100"
@inherits R_Page
@attribute [R_Page(ResourceId = "_UnitList")]
@inject R_ILocalizer<Resources_PMT00100_Class> _localizer

<R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout col="1">
            <R_Label FontStyle="R_eFontStyle.Bold"
                     FontColor="R_eFontColor.Danger">
                @_localizer["_Prop"]
            </R_Label>
        </R_ItemLayout>
        <R_ItemLayout col="3">
            <R_ComboBox Data="@_viewModel.PropertyList"
                        Value="_viewModel.PropertyValue.CPROPERTY_ID"
                        ValueField="@nameof(PropertyDTO.CPROPERTY_ID)"
                        TextField="@nameof(PropertyDTO.CPROPERTY_NAME)"
                        ValueChanged="@((string value) => PropertyDropdown_OnChange(value))">
            </R_ComboBox>
        </R_ItemLayout>
    </R_StackLayout>
</R_StackLayout>

<R_StackLayout>
    <R_StackLayout Row="true">
        <R_ItemLayout col="2">
            <R_Grid @ref="@_gridBuilding"
                    DataSource="_viewModel.BuildingList"
                    R_ConductorGridSource="@_conductorBuilding"
                    R_GridType="R_eGridType.Original"
                    R_ServiceGetListRecord="GetListBuilding"
                    R_Display="@R_DisplayBuildingAsync"
                    AllowDeleteRow="false"
                    AllowAddNewRow="false"
                    AllowEditRow="false"
                    Pageable
                    Height="510px"
                    Enabled="@_gridBuildingEnabled">
                <R_GridColumns>
                    <R_GridTextColumn FieldName="@nameof(PMT00100BuildingDTO.CBUILDING_NAME)"
                                      HeaderText=@_localizer["_BuildingName"] Width="150px">
                    </R_GridTextColumn>
                </R_GridColumns>
            </R_Grid>
            </R_ItemLayout>
            <R_ItemLayout col="10">
            <R_Grid @ref="@_gridBuildingUnit"
                    DataSource="_viewModel.BuildingUnitList"
                    R_ConductorGridSource="@_conductorBuildingUnit"
                    R_GridType="R_eGridType.Original"
                    R_ServiceGetListRecord="GetListBuildingUnit"
                    R_Display="@R_DisplayBuildingUnit"
                    Pageable
                    AllowDeleteRow="false"
                    AllowAddNewRow="false"
                    AllowEditRow="false"
                    Height="230px"
                    @bind-PageSize="@_pageSize"
                    Enabled="@_gridBuildingEnabled">
                <R_GridColumns>
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CFLOOR_NAME)"
                                      HeaderText=@_localizer["_CFloorName"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CUNIT_ID)"
                                      HeaderText=@_localizer["_CUnitId"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CUNIT_TYPE_NAME)"
                                      HeaderText=@_localizer["_CUnitTypeName"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridNumericColumn FieldName="@nameof(PMT00100DTO.NGROSS_AREA_SIZE)"
                                         TValue="decimal"
                                         HeaderText=@_localizer["_NGrossAreaSize"] Width="150px" />
                    <R_GridNumericColumn FieldName="@nameof(PMT00100DTO.NNET_AREA_SIZE)"
                                         TValue="decimal"
                                         HeaderText=@_localizer["_NNetAreaSize"] Width="150px" />
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CUNIT_VIEW_NAME)"
                                      HeaderText=@_localizer["_CUnitViewName"] Width="150px" />
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CSTRATA_STATUS_DESC)"
                                      HeaderText=@_localizer["_Status"] Width="150px" />
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CUPDATE_BY)"
                                      HeaderText=@_localizer["_UpdatedBy"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridDateTimePickerColumn FieldName="@nameof(PMT00100DTO.DUPDATE_DATE)"
                                                HeaderText=@_localizer["_UpdatedDate"] Width="180px">
                    </R_GridDateTimePickerColumn>
                    <R_GridTextColumn FieldName="@nameof(PMT00100DTO.CCREATE_BY)"
                                      HeaderText=@_localizer["_CreateBy"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridDateTimePickerColumn FieldName="@nameof(PMT00100DTO.DCREATE_DATE)"
                                                HeaderText=@_localizer["_CreateDate"] Width="180px">
                    </R_GridDateTimePickerColumn>
                </R_GridColumns>
            </R_Grid>

            <R_StackLayout Row="true">
                <R_ItemLayout>
                    <R_Popup R_Before_Open_Popup="@BeforeOpenPopupBooking"
                             R_After_Open_Popup="@AfterOpenPopupBooking"
                             Enabled="@_viewModel.btnSold_Booking">
                        @_localizer["_Booking"]
                    </R_Popup>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Detail R_Before_Open_Detail="@BeforeOpenSold"
                              R_After_Open_Detail="@AfterOpenSold"
                              Enabled="@_viewModel.btnSold_Booking">
                        @_localizer["_Sold"]
                    </R_Detail>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Detail R_Before_Open_Detail="@BeforeOpenViewImage"
                              R_After_Open_Detail="@AfterOpenViewImage"
                              Enabled="@_viewModel.btnViewImage">
                        @_localizer["_ViewImage"]
                    </R_Detail>
                </R_ItemLayout>
            </R_StackLayout>

            <R_Grid @ref="@_gridAgreementByUnit"
                    DataSource="_viewModel.AgreementByUnitList"
                    R_ConductorGridSource="@_conductorAgreementByUnit"
                    R_GridType="R_eGridType.Original"
                    R_ServiceGetListRecord="GetListAgreementByUnit"
                    R_Display="@R_DisplayAgreementByUnit"
                    Pageable
                    AllowDeleteRow="false"
                    AllowAddNewRow="false"
                    AllowEditRow="false"
                    Height="230px"
                    @bind-PageSize="@_pageSize"
                    Enabled="@_gridBuildingEnabled">
                <R_GridColumns>
                    <R_GridTextColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.CTENANT_NAME)"
                                      HeaderText=@_localizer["_Tenant"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridTextColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.CSALESMAN_NAME)"
                                      HeaderText=@_localizer["_Salesman"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridTextColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.CREF_NO)"
                                      HeaderText=@_localizer["_RefNo"] Width="175px">
                    </R_GridTextColumn>
                    <R_GridDatePickerColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.DREF_DATE)"
                                                HeaderText=@_localizer["_DRefDate"] Width="150px">
                    </R_GridDatePickerColumn>
                    <R_GridNumericColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.NBOOKING_FEE)"
                                         TValue="decimal" HeaderText=@_localizer["_BookingFee"] Width="150px" />
                    <R_GridCheckBoxColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.LPAID)"
                                          HeaderText=@_localizer["_Paid"] Width="100px" />
                    <R_GridTextColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.CTRANS_STATUS_DESCR)"
                                      HeaderText=@_localizer["_Status"] Width="150px" />
                    <R_GridTextColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.CUPDATE_BY)"
                                      HeaderText=@_localizer["_UpdatedBy"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridDateTimePickerColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.DUPDATE_DATE)"
                                                HeaderText=@_localizer["_UpdatedDate"] Width="180px">
                    </R_GridDateTimePickerColumn>
                    <R_GridTextColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.CCREATE_BY)"
                                      HeaderText=@_localizer["_CreateBy"] Width="150px">
                    </R_GridTextColumn>
                    <R_GridDateTimePickerColumn FieldName="@nameof(PMT00100AgreementByUnitDTO.DCREATE_DATE)"
                                                HeaderText=@_localizer["_CreateDate"] Width="180px">
                    </R_GridDateTimePickerColumn>
                </R_GridColumns>
            </R_Grid>
            <R_StackLayout Row="true">
                <R_ItemLayout>
                    <R_Popup R_Before_Open_Popup="@BeforeOpenPopupChangeUnit" R_After_Open_Popup="@AfterOpenPopupChangeUnitAsync"
                             Enabled="@_viewModel.btnChangeUnitAndRealease">
                        @_localizer["_ChangeUnit"]
                    </R_Popup>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Popup R_Before_Open_Popup="@BeforeOpenPopupView" R_After_Open_Popup="@AfterOpenPopupView"
                             Enabled="@_viewModel.btnChangeUnitAndRealease">
                        @_localizer["_View"]
                    </R_Popup>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Button
                        Enabled="@(_viewModel.btnChangeUnitAndRealease && _viewModel.lControlButtonSubmit)"
                              OnClick="@SubmitBtn">
                        @_localizer["_Submit"]
                    </R_Button>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Button Enabled="@(_viewModel.btnChangeUnitAndRealease && _viewModel.lControlButtonRedraft)"
                              OnClick="@RedraftBtn">
                        @_localizer["_Redraft"]
                    </R_Button>
                </R_ItemLayout>
            </R_StackLayout>

            </R_ItemLayout>
            </R_StackLayout>
            </R_StackLayout>
            <R_ConductorGrid @ref="@_conductorBuilding"
                      R_IsHeader />
<R_ConductorGrid @ref="@_conductorBuildingUnit" />
<R_ConductorGrid @ref="@_conductorAgreementByUnit" />
