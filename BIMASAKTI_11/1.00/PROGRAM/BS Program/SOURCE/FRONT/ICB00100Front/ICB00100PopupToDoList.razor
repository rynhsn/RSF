@page "/ICB00100PopupToDoList"
@using R_BlazorFrontEnd.Interfaces
@using ICB00100FrontResources
@using ICB00100Common.DTOs
@inherits R_Page
@attribute [R_Page(Title = "Todo List prior to Soft Close TX Period")]
@inject R_ILocalizer<Resources_Dummy_Class> _localizer

<R_StackLayout Row>
    <R_ItemLayout col="12">
        <R_Grid @ref="@_gridRef"
                DataSource="@_viewModel.ValidateSoftCloseList"
                Pageable="true"
                R_ConductorGridSource="@_conductorRef"
                R_GridType="@R_eGridType.Batch"
                R_ServiceGetListRecord="GetListRecord"
                AllowAddNewRow="false"
                AllowEditRow="false"
                AllowDeleteRow="false"
                Height="400px"
                Width="1000px"
                PageSize="17">
            <R_GridColumns>
                <R_GridNumericColumn TValue="long" FieldName=@nameof(ICB00100ValidateSoftCloseDTO.INO) HeaderText=@_localizer["NO"] Enabled="false" Width="100px"/>
                <R_GridTextColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.CDEPARTMENT) HeaderText=@_localizer["DEPT"] Enabled="false" Width="150px"/>
                <R_GridTextColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.CTRANSACTION_NAME) HeaderText=@_localizer["TRANSACTION_TYPE"] Enabled="false" Width="200px"/>
                <R_GridTextColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.CREF_NO) HeaderText=@_localizer["REF_NO"] Enabled="false" Width="200px"/>
                <R_GridDateTimePickerColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.DREF_DATE) HeaderText=@_localizer["REF_DATE"] Enabled="false" Width="150px"/>
                <R_GridTextColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.CSTATUS_NAME) HeaderText=@_localizer["STATUS"] Enabled="false" Width="100px"/>
                <R_GridTextColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.CDESCRIPTION) HeaderText=@_localizer["DESCRIPTION"] Enabled="false" Width="300px"/>
                <R_GridTextColumn FieldName=@nameof(ICB00100ValidateSoftCloseDTO.CSOLUTION) HeaderText=@_localizer["SOLUTION"] Enabled="false" Width="300px"/>

            </R_GridColumns>
        </R_Grid>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Row>
    <R_ItemLayout>
        <R_Button Enabled="@(_viewModel.ValidateSoftCloseList.Count>0)" OnClick="OnClickSaveToExcel">
            @_localizer["SAVE_TO_EXCEL"]
        </R_Button>
    </R_ItemLayout>
</R_StackLayout>

<R_ConductorGrid @ref="@_conductorRef"
             R_IsHeader/>