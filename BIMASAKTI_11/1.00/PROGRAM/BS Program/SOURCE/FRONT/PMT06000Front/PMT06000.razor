@page "/PMT06000"
@using PMT06000FrontResources
@using R_BlazorFrontEnd.Interfaces
@using PMT06000Common.DTOs
@inherits R_Page
@inject R_ILocalizer<Resources_Dummy_Class> _localizer

<R_StackLayout Row Class="mb-1">
    <R_ItemLayout col="2">
        <R_Label FontColor="R_eFontColor.Danger">@_localizer["PROPERTY_UPPR"]</R_Label>
    </R_ItemLayout>
    <R_ItemLayout col="3">
        <R_ComboBox Data="@_viewModel.PropertyList"
                    Value="@_viewModel.SelectedPropertyId"
                    ValueField="@nameof(PMT06000PropertyDTO.CPROPERTY_ID)"
                    TextField="@nameof(PMT06000PropertyDTO.CPROPERTY_NAME)"
                    ValueChanged="@((string value) => OnChangedCombo(value, "property"))"/>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Row>
    <R_ItemLayout col="2">
        <R_RadioGroup Data="@_viewModel.RadioPeriodType"
                      @bind-Value="_viewModel.SelectedPeriodType"
                      ValueField="Key"
                      TextField="Value"
                      Enabled/>
    </R_ItemLayout>
    <R_ItemLayout col="1">
        <R_NumericTextBox @bind-Value="_viewModel.SelectedYear"
                          Min="_viewModel.YearRange.IMIN_YEAR"
                          Max="_viewModel.YearRange.IMAX_YEAR"
                          ThousandSeparator="false"
                          Enabled="@(_viewModel.SelectedPeriodType == "S")"/>
    </R_ItemLayout>
    <R_ItemLayout col="1">
        <R_ComboBox Data="@_viewModel.PeriodList"
                    Value="@_viewModel.SelectedPeriodNo"
                    ValueField="@nameof(PMT06000PeriodDTO.CPERIOD_NO)"
                    TextField="@nameof(PMT06000PeriodDTO.CPERIOD_NO)"
                    ValueChanged="@((string value) => OnChangedCombo(value, "periodNo"))"
                    Enabled="@(_viewModel.SelectedPeriodType == "S")"/>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Button OnClick="OnClickRefresh">@_localizer["REFRESH"]</R_Button>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout>
    <R_ItemLayout>
        <R_Grid @ref="_gridRefOvertime"
                DataSource="_viewModel.OvertimeGridList"
                R_ConductorSource="_conductorRefOvertime"
                R_GridType="R_eGridType.Navigator"
                R_ServiceGetListRecord="GetOvertimeListRecord"
                Pageable
                @bind-PageSize="@_pageSizeOvt"
                Width="100%"
                Height="260px">
            <R_GridColumns>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CTRANS_STATUS_DESC)" HeaderText="@_localizer["TRANS_STATUS"]" Width="120px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CTENANT_DISPLAY)" HeaderText="@_localizer["TENANT"]" Width="150px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CBUILDING_NAME)" HeaderText="@_localizer["BUILDING"]" Width="150px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CREF_NO)" HeaderText="@_localizer["REF_NO"]" Width="200px"/>
                <R_GridDatePickerColumn FieldName="@nameof(PMT06000OvtGridDTO.DREF_DATE)" HeaderText="@_localizer["REF_DATE"]" Width="120px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CDESCRIPTION)" HeaderText="@_localizer["DESCRIPTION"]" Width="200px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CREQUEST_NAME)" HeaderText="@_localizer["REQUEST_NAME"]" Width="200px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CAGREEMENT_NO)" HeaderText="@_localizer["AGRMT_NO"]" Width="200px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CINVOICE_NO)" HeaderText="@_localizer["INVOICE_NO"]" Width="200px"/>
                <R_GridDatePickerColumn FieldName="@nameof(PMT06000OvtGridDTO.DINVOICE_DATE)" HeaderText="@_localizer["INVOICE_DATE"]" Width="120px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CUPDATE_BY)" HeaderText="@_localizer["UPDATED_BY"]" Width="120px"/>
                <R_GridDateTimePickerColumn FieldName="@nameof(PMT06000OvtGridDTO.DUPDATE_DATE)" HeaderText="@_localizer["UPDATED_DATE"]" Width="150px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtGridDTO.CCREATE_BY)" HeaderText="@_localizer["CREATED_BY"]" Width="120px"/>
                <R_GridDateTimePickerColumn FieldName="@nameof(PMT06000OvtGridDTO.DCREATE_DATE)" HeaderText="@_localizer["CREATED_DATE"]" Width="150px"/>
            </R_GridColumns>
        </R_Grid>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout AlignItems="R_eAlignItems.End" Class="mb-3">
    <R_ItemLayout>
        <R_Button Enabled="@(_viewModel.OvertimeGridList.Count > 0 && _viewModel.Data.CTRANS_STATUS is "00" or "10")"
                  OnClick="OnClickSubmit">
            @(_viewModel.Data.CTRANS_STATUS == "10" ? _localizer["DRAFT"] : _localizer["SUBMIT"])
        </R_Button>
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Row>
    <R_ItemLayout col="6">
        <R_Grid @ref="_gridRefService"
                DataSource="_viewModel.OvertimeServiceGridList"
                R_ConductorGridSource="_conductorRefService"
                R_GridType="R_eGridType.Original"
                R_ServiceGetListRecord="GetOvertimeServiceListRecord"
                Pageable
                @bind-PageSize="@_pageSizeService"
                AllowAddNewRow="false"
                AllowDeleteRow="false"
                AllowEditRow="false"
                Width="100%"
                Height="250px"
                R_Display="DisplayService">
            <R_GridColumns>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtServiceGridDTO.CSEQ_NO)" HeaderText="@_localizer["SEQ_NO"]" Width="100px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtServiceGridDTO.CSERVICE_DISPLAY)" HeaderText="@_localizer["SERVICE"]" Width="210px"/>
                <R_GridDateTimePickerColumn FieldName="@nameof(PMT06000OvtServiceGridDTO.DDATE_IN)" HeaderText="@_localizer["DATE_IN"]" Width="140px"/>
                <R_GridDateTimePickerColumn FieldName="@nameof(PMT06000OvtServiceGridDTO.DDATE_OUT)" HeaderText="@_localizer["DATE_OUT"]" Width="140px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtServiceGridDTO.CSERVICE_DESCR)" HeaderText="@_localizer["DESCRIPTION"]" Width="300px"/>
            </R_GridColumns>
        </R_Grid>
    </R_ItemLayout>

    <R_ItemLayout col="6">
        <R_Grid @ref="_gridRefUnit"
                DataSource="_viewModel.OvertimeUnitGridList"
                R_ConductorGridSource="_conductorRefUnit"
                R_GridType="R_eGridType.Original"
                R_ServiceGetListRecord="GetOvertimeUnitListRecord"
                Pageable
                @bind-PageSize="@_pageSizeUnit"
                AllowAddNewRow="false"
                AllowDeleteRow="false"
                AllowEditRow="false"
                Width="100%"
                Height="250px">
            <R_GridColumns>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtUnitDTO.CUNIT_ID)" HeaderText="@_localizer["UNIT_ID"]" Width="120px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtUnitDTO.CUNIT_NAME)" HeaderText="@_localizer["UNIT_NAME"]" Width="200px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtUnitDTO.CFLOOR_ID)" HeaderText="@_localizer["FLOOR"]" Width="200px"/>
                <R_GridNumericColumn TValue="decimal" FieldName="@nameof(PMT06000OvtUnitDTO.NGROSS_AREA_SIZE)" HeaderText="@_localizer["SQM"]" Width="120px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtUnitDTO.CUPDATE_BY)" HeaderText="@_localizer["UPDATED_BY"]" Width="120px"/>
                <R_GridDateTimePickerColumn FieldName="@nameof(PMT06000OvtUnitDTO.DUPDATE_DATE)" HeaderText="@_localizer["UPDATED_DATE"]" Width="150px"/>
                <R_GridTextColumn FieldName="@nameof(PMT06000OvtUnitDTO.CCREATE_BY)" HeaderText="@_localizer["CREATED_BY"]" Width="120px"/>
                <R_GridDateTimePickerColumn FieldName="@nameof(PMT06000OvtUnitDTO.DCREATE_DATE)" HeaderText="@_localizer["CREATED_DATE"]" Width="150px"/>
            </R_GridColumns>
        </R_Grid>
    </R_ItemLayout>
</R_StackLayout>

<R_Conductor @ref="_conductorRefOvertime"
             R_ViewModel="_viewModel"
             R_IsHeader
             R_ServiceGetRecord="GetRecord"/>

<R_ConductorGrid @ref="_conductorRefService"/>
<R_ConductorGrid @ref="_conductorRefUnit"/>

<R_PredefinedDock R_InstantiateDock="InstatiateTabInfo" R_AfterOpenPredefinedDock="AfterOpenInfo" Title="@_localizer["OVERTIME_INFO"]"/>