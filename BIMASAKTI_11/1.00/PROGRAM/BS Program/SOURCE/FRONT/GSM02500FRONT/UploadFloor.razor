@inherits R_Page
@attribute [R_Page(Title = "Upload")]
@using GSM02500COMMON.DTOs.GSM02520
@using GSM02500COMMON.DTOs.GSM02530
@using GSM02500COMMON.DTOs.GSM02531;

<R_StackLayout Style="width:1000px">

    <R_StackLayout>
        <R_StackLayout Row>
            <R_ItemLayout col="2">
                <R_Label>@_localizer["_Property"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="2">
                <R_TextBox R_ConductorGridSource="_conGridUploadFloorRef"
                           Enabled="false"
                           @bind-Value="loUploadFloorViewModel.loParameter.PropertyData.CPROPERTY_ID">
                </R_TextBox>
            </R_ItemLayout>
            <R_ItemLayout col="8">
                <R_TextBox R_ConductorGridSource="_conGridUploadFloorRef"
                           Enabled="false"
                           @bind-Value="loUploadFloorViewModel.loParameter.PropertyData.CPROPERTY_NAME">
                </R_TextBox> 
            </R_ItemLayout>
        </R_StackLayout>
        <R_StackLayout Row>
            <R_ItemLayout col="2">
                <R_Label>@_localizer["_Building"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="2">
                <R_TextBox R_ConductorGridSource="_conGridUploadFloorRef"
                           Enabled="false"
                           @bind-Value="loUploadFloorViewModel.loParameter.BuildingData.CBUILDING_ID">
                </R_TextBox>
            </R_ItemLayout>
            <R_ItemLayout col="8">
                <R_TextBox R_ConductorGridSource="_conGridUploadFloorRef"
                           Enabled="false"
                           @bind-Value="loUploadFloorViewModel.loParameter.BuildingData.CBUILDING_NAME">
                </R_TextBox>
            </R_ItemLayout>
        </R_StackLayout>
        <R_StackLayout Row>
            <R_InputFile OnChange="OnChangeInputFile" Accepts="@accepts"></R_InputFile>
        </R_StackLayout>
    </R_StackLayout>
    <R_TabStrip OnActiveTabIndexChanged="OnActiveTabIndexChanged" @ref="_tabStripRef">
        <R_TabStripTab Title="@_localizer["_Floor"]" Id="Floor">
            <R_StackLayout>
                <R_StackLayout Row>
                    <R_ItemLayout col="12">
                        <R_Grid @ref="@_gridUploadFloorRef"
                                DataSource="@loUploadFloorViewModel.loUploadFloorDisplayList"
                                Pageable="true"
                                R_ConductorGridSource="@_conGridUploadFloorRef"
                                R_GridType="@R_eGridType.Batch"
                                Height="350px"
                                AllowAddNewRow="false"
                                AllowEditRow="false"
                                AllowDeleteRow="false"
                                R_ServiceGetListRecord="@Grid_R_ServiceGetFloorListRecord">
                            <R_GridColumns>
                                <R_GridNumericColumn TValue="int" FieldName=@nameof(UploadFloorDTO.No) HeaderText="@_localizer["_No"]" Enabled="false" Width="75px"></R_GridNumericColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.FloorCode) HeaderText="@_localizer["_FloorCode"]" Enabled="false" Width="125px"></R_GridTextColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.FloorName) HeaderText="@_localizer["_FloorName"]" Enabled="false" Width="200px"></R_GridTextColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.Description) HeaderText="@_localizer["_Description"]" Enabled="false" Width="350px"></R_GridTextColumn>
                                <R_GridCheckBoxColumn FieldName=@nameof(UploadFloorDTO.Active) HeaderText="@_localizer["_Active"]" Enabled="false" Width="100px"></R_GridCheckBoxColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.NonActiveDate) HeaderText="@_localizer["_NonActiveDate"]" Enabled="false" Width="150px"></R_GridTextColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.UnitType) HeaderText="@_localizer["_UnitType"]" Enabled="false" Width="150px"></R_GridTextColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.UnitCategory) HeaderText="@_localizer["_UnitCategory"]" Enabled="false" Width="150px"></R_GridTextColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.Valid) HeaderText="@_localizer["_Valid"]" Enabled="false" Width="75px"></R_GridTextColumn>
                                <R_GridTextColumn FieldName=@nameof(UploadFloorDTO.Notes) HeaderText="@_localizer["_Notes"]" Enabled="false" Width="350px"></R_GridTextColumn>
                            </R_GridColumns>
                        </R_Grid>
                    </R_ItemLayout>
                </R_StackLayout>
             </R_StackLayout>
        </R_TabStripTab>
        <R_TabStripTab Title="@_localizer["_Unit"]" Id="Unit">
            <R_StackLayout Row>
                <R_ItemLayout col="12">
                    <R_Grid @ref="@_gridUploadUnitRef"
                            DataSource="@loUploadUnitViewModel.loUploadUnitDisplayList"
                            Pageable="true"
                            R_ConductorGridSource="@_conGridUploadUnitRef"
                            R_GridType="@R_eGridType.Batch"
                            Height="350px"
                            AllowAddNewRow="false"
                            AllowEditRow="false"
                            AllowDeleteRow="false"
                            R_ServiceGetListRecord="@Grid_R_ServiceGetUnitListRecord">
                        <R_GridColumns>
                            <R_GridNumericColumn TValue="int" FieldName=@nameof(UploadUnitDTO.No) HeaderText="@_localizer["_No"]" Enabled="false" Width="75px"></R_GridNumericColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.FloorId) HeaderText="@_localizer["_FloorId"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.UnitId) HeaderText="@_localizer["_UnitId"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.UnitName) HeaderText="@_localizer["_UnitName"]" Enabled="false" Width="250px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.UnitType) HeaderText="@_localizer["_UnitType"]" Enabled="false" Width="150px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.UnitView) HeaderText="@_localizer["_UnitView"]" Enabled="false" Width="150px"></R_GridTextColumn>
                            <R_GridNumericColumn TValue="decimal" FieldName=@nameof(UploadUnitDTO.GrossSize) HeaderText="@_localizer["_GrossSize"]" Enabled="false" Width="125px"></R_GridNumericColumn>
                            <R_GridNumericColumn TValue="decimal" FieldName=@nameof(UploadUnitDTO.NetSize) HeaderText="@_localizer["_NetSize"]" Enabled="false" Width="125px"></R_GridNumericColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.UnitCategory) HeaderText="@_localizer["_UnitCategory"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.StrataStatus) HeaderText="@_localizer["_StrataStatus"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.LeaseStatus) HeaderText="@_localizer["_LeaseStatus"]" Enabled="false" Width="150px"></R_GridTextColumn>
                            <R_GridCheckBoxColumn FieldName=@nameof(UploadUnitDTO.Active) HeaderText="@_localizer["_Active"]" Enabled="false" Width="100px"></R_GridCheckBoxColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.NonActiveDate) HeaderText="@_localizer["_NonActiveDate"]" Enabled="false" Width="150px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.Valid) HeaderText="@_localizer["_Valid"]" Enabled="false" Width="75px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitDTO.Notes) HeaderText="@_localizer["_Notes"]" Enabled="false" Width="300px"></R_GridTextColumn>
                        </R_GridColumns>
                    </R_Grid>
                </R_ItemLayout>
            </R_StackLayout>
        </R_TabStripTab>
        <R_TabStripTab Title="@_localizer["_Utility"]" Id="Utility">
            <R_StackLayout Row>
                <R_ItemLayout col="12">
                    <R_Grid @ref="@_gridUploadUnitUtilityRef"
                            DataSource="@loUploadUnitUtilityViewModel.loUploadUnitUtilityDisplayList"
                            Pageable="true"
                            R_ConductorGridSource="@_conGridUploadUnitUtilityRef"
                            R_GridType="@R_eGridType.Batch"
                            Height="350px"
                            AllowAddNewRow="false"
                            AllowEditRow="false"
                            AllowDeleteRow="false"
                            R_ServiceGetListRecord="@Grid_R_ServiceGetUnitUtilityListRecord">
                        <R_GridColumns>
                            <R_GridNumericColumn TValue="int" FieldName=@nameof(UploadUnitUtilityDTO.No) HeaderText="@_localizer["_No"]" Enabled="false" Width="75px"></R_GridNumericColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.FloorId) HeaderText="@_localizer["_FloorId"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.UnitId) HeaderText="@_localizer["_UnitId"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.UtilityType) HeaderText="@_localizer["_UtilityType"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.SeqNo) HeaderText="@_localizer["_SeqNo"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.MeterNo) HeaderText="@_localizer["_MeterNo"]" Enabled="false" Width="100px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.AliasMeterNo) HeaderText="@_localizer["_BASAliasMeterNo"]" Enabled="false" Width="250px"></R_GridTextColumn>
                            <R_GridNumericColumn TValue="decimal" FieldName=@nameof(UploadUnitUtilityDTO.CalculationFactor) HeaderText="@_localizer["_CalculationFactor"]" Enabled="false" Width="150px"></R_GridNumericColumn>
                            <R_GridNumericColumn TValue="decimal" FieldName=@nameof(UploadUnitUtilityDTO.Capacity) HeaderText="@_localizer["_Capacity"]" Enabled="false" Width="150px"></R_GridNumericColumn>
                            <R_GridNumericColumn TValue="int" FieldName=@nameof(UploadUnitUtilityDTO.MaxResetValue) HeaderText="@_localizer["_MaxResetValue"]" Enabled="false" Width="125px"></R_GridNumericColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.Valid) HeaderText="@_localizer["_Valid"]" Enabled="false" Width="75px"></R_GridTextColumn>
                            <R_GridTextColumn FieldName=@nameof(UploadUnitUtilityDTO.Notes) HeaderText="@_localizer["_Notes"]" Enabled="false" Width="300px"></R_GridTextColumn>
                        </R_GridColumns>
                    </R_Grid>
                </R_ItemLayout>
            </R_StackLayout>
        </R_TabStripTab>
    </R_TabStrip>
    
    <R_StackLayout Row>
        <R_ItemLayout col="12">
            <R_ProgressBar Label="@lcMessage" MaxValue="100" Value="@lnPercentage"></R_ProgressBar>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout col="8">
            <R_StackLayout Row>
                <R_ItemLayout col="3">
                    <R_Label>@_localizer["_TotalRows"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_NumericTextBox @bind-Value="@lnTotalRow"
                                Arrows="false"
                                Enabled="false">
                    </R_NumericTextBox>
                </R_ItemLayout>
                <R_ItemLayout col="1">
                    <R_Label>@_localizer["_Valid"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2" Class="bg-success">
                    <R_NumericTextBox @bind-Value="@lnValid"
                                        ReadOnly
                                        Arrows="false"
                                        Enabled="false">
                    </R_NumericTextBox>
                </R_ItemLayout>
                <R_ItemLayout col="1">
                    <R_Label>@_localizer["_Invalid"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2" Class="badge bg-danger">
                    <R_NumericTextBox @bind-Value="@lnInvalid"
                                        ReadOnly
                                        Arrows="false"
                                        Enabled="false">
                    </R_NumericTextBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
                    <R_ItemLayout col="4" hidden="@IsErrorHappened">
            <R_StackLayout Row Class="justify-content-end">
                <R_ItemLayout>
                    <R_Button OnClick="OnCancel">
                        @_localizer["_Cancel"]
                    </R_Button>
                    <R_Button OnClick="OnProcess" Enabled="@IsProcessEnabled">
                        @_localizer["_Process"]
                    </R_Button>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
            <R_ItemLayout col="4" hidden="@(!IsErrorHappened)">
            <R_StackLayout Row Class="justify-content-end">
                <R_ItemLayout>
                    <R_Button OnClick="OnCancel">
                        @_localizer["_Cancel"]
                    </R_Button>
                    <R_Button OnClick="@OnSaveToExcel">
                        @_localizer["_SavetoExcel"]
                    </R_Button>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>
</R_StackLayout>
<R_ConductorGrid @ref="@_conGridUploadFloorRef"
                 R_ViewModel="@loUploadFloorViewModel"
                 R_IsHeader
                 R_BeforeSaveBatch="@R_BeforeSaveFloorBatch"
                 R_ServiceSaveBatch="@R_ServiceSaveFloorBatch"
                 R_AfterSaveBatch="@R_AfterSaveFloorBatch">
</R_ConductorGrid>

<R_ConductorGrid @ref="@_conGridUploadUnitRef"
                 R_ViewModel="@loUploadUnitViewModel"
                 R_ConductorParent="@_conGridUploadFloorRef"
                 R_BeforeSaveBatch="@R_BeforeSaveUnitBatch"
                 R_ServiceSaveBatch="@R_ServiceSaveUnitBatch"
                 R_AfterSaveBatch="@R_AfterSaveUnitBatch">
</R_ConductorGrid>

<R_ConductorGrid @ref="@_conGridUploadUnitUtilityRef"
                 R_ViewModel="@loUploadUnitUtilityViewModel"
                 R_ConductorParent="@_conGridUploadFloorRef"
                 R_BeforeSaveBatch="@R_BeforeSaveUnitUtilityBatch"
                 R_ServiceSaveBatch="@R_ServiceSaveUnitUtilityBatch"
                 R_AfterSaveBatch="@R_AfterSaveUnitUtilityBatch">
</R_ConductorGrid>