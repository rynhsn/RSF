@using ICT00900COMMON.Utility_DTO;
@inherits R_Page
@attribute [R_Page(ResourceId = "_AdjustmentDetail")]
@inject R_ILocalizer<Resources_ICT00900_Class> _localizer

<R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_Departement"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_TextBox @bind-Value="@_viewModel.Data.CDEPT_CODE"
                               R_ConductorSource="_conducorAdjDetail"
                               OnLostFocus="@OnLostFocusDepartment"
                               R_EnableAdd
                               @ref="@FocusLabel">
                    </R_TextBox>
                    </R_ItemLayout>
                    <R_ItemLayout>
                    <R_Lookup @ref="@R_Lookup_Button_Dept"
                              R_ConductorSource="@_conducorAdjDetail"
                              R_Before_Open_Lookup="@BeforeOpenLookUp_Department"
                              R_After_Open_Lookup="@AfterOpenLookUpDepartment"
                              R_EnableAdd>
                        ...
                    </R_Lookup>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_TextBox @bind-Value="@_viewModel.Data.CDEPT_NAME"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="false">
                    </R_TextBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_StackLayout Row>
                <R_ItemLayout col="4">
                    <R_Label>@_localizer["_TrxStatus"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="7">
                    <R_TextBox @bind-Value="@_viewModel.Data.CTRANS_STATUS_DESCR"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="false">
                    </R_TextBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_Transaction"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_TextBox @bind-Value="@_viewModel.Data.CTRANS_CODE"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="false">
                    </R_TextBox>
                </R_ItemLayout>
                <R_ItemLayout col="7" Class="pe-5">
                    <R_TextBox @bind-Value="@_viewModel.Data.CTRANS_CODE_DESCR"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="false">
                    </R_TextBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_RefNo"]*</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_TextBox @bind-Value="@_viewModel.Data.CREF_NO"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="@(!_viewModel.lControlCRUDMode && _viewModel._lDataCREF_NO)">
                    </R_TextBox>
                </R_ItemLayout>
                <R_ItemLayout col="1">
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_RefDateDetail"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="3" Class="pe-5">
                    <R_DatePicker @bind-Value="@_viewModel.Data.DREF_DATE"
                                  R_ConductorSource="_conducorAdjDetail"
                                    R_EnableAdd
                                    R_EnableEdit>
                    </R_DatePicker>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

    </R_StackLayout>


    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_AdjustmentMethod"]</R_Label>
                </R_ItemLayout>

                <R_ItemLayout col="7">
                    <R_ItemLayout col="12">

                        <R_ItemLayout>
                            <R_RadioGroup R_ConductorSource="@_conducorAdjDetail"
                                          Data="@_viewModel.AdjustmentMethodList"
                                          @bind-Value="@_viewModel.Data.CADJUST_METHOD"
                                          Layout="@R_eRadioGroupLayout.Horizontal"
                                            R_EnableAdd
                                            R_EnableEdit
                                          ValueField="@nameof(ComboBoxDTO.CCODE)"
                                          TextField="@nameof(ComboBoxDTO.CDESCRIPTION)" />
                            </R_ItemLayout>
                            </R_ItemLayout>
                            </R_ItemLayout>
                            </R_StackLayout>
                            </R_ItemLayout>
                            </R_StackLayout>

                            <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_Product"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_TextBox @bind-Value="@_viewModel.Data.CPRODUCT_ID"
                               R_ConductorSource="_conducorAdjDetail"
                               OnLostFocus="@OnLostFocusProduct"
                               R_EnableAdd
                               R_EnableEdit>
                    </R_TextBox>
                    </R_ItemLayout>
                    <R_ItemLayout>
                    <R_Lookup @ref="@R_Lookup_Button_Product"
                              R_ConductorSource="@_conducorAdjDetail"
                              R_Before_Open_Lookup="@BeforeOpenLookUp_Product"
                              R_After_Open_Lookup="@AfterOpenLookProduct"
                              R_EnableAdd="true"
                              R_EnableEdit="true">
                        ...
                    </R_Lookup>
                    </R_ItemLayout>
                    <R_ItemLayout col="6">
                    <R_TextBox @bind-Value="@_viewModel.Data.CPRODUCT_NAME"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="false">
                    </R_TextBox>
                    </R_ItemLayout>
                    </R_StackLayout>
                    </R_ItemLayout>
                    </R_StackLayout>

        <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_AdjValue"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_NumericTextBox @bind-Value="@_viewModel.Data.NADJUST_AMOUNT"
                                      R_ConductorSource="_conducorAdjDetail"
                                      Min="0"
                                      TValue="decimal"
                                      Arrows="false"
                                            R_EnableAdd
                                            R_EnableEdit>
                    </R_NumericTextBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_Currency"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_DropDownList Data="@_viewModel.CurrencyList"
                                    Value="@_viewModel.Data.CCURRENCY_CODE"
                                        ValueField="@nameof(CurrencyDTO.CCURRENCY_CODE)"
                                        TextField="@nameof(CurrencyDTO.CCURRENCY_DISPLAY)"
                                    R_ConductorSource="@_conducorAdjDetail"
                                    ValueChanged="@((string value) => OnChangedCurrencyCode(value))"
                                            R_EnableAdd
                                        R_EnableEdit
                                        PopupMaxHeight="150px"/>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

        <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_CurrencyRate"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_LocalCurrency"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_StackLayout Row>
                         <R_ItemLayout col="4">
                            <R_NumericTextBox  @bind-Value="@_viewModel.Data.NLBASE_RATE"
                                R_ConductorSource="_conducorAdjDetail"
                                TValue="decimal"
                                Enabled="false"
                                Arrows="false">

                            </R_NumericTextBox>
                        </R_ItemLayout>
                        <R_ItemLayout col="2">
                            <R_TextBox @bind-Value="@_viewModel.Data.CCURRENCY_CODE"
                                       R_ConductorSource="_conducorAdjDetail"
                                       Enabled="false">

                            </R_TextBox>
                        </R_ItemLayout>
                         <R_ItemLayout>
                            <R_Label>=</R_Label>
                         </R_ItemLayout>
                        <R_ItemLayout col="4">
                            <R_NumericTextBox @bind-Value="@_viewModel.Data.NLCURRENCY_RATE"
                                              R_ConductorSource="_conducorAdjDetail"
                                              TValue="decimal"
                                              Enabled="false"
                                              Arrows="false">

                            </R_NumericTextBox>
                        </R_ItemLayout>
                        <R_ItemLayout col="2">
                            <R_TextBox @bind-Value="@_viewModel.Data.CLOCAL_CURRENCY_CODE"
                                       R_ConductorSource="_conducorAdjDetail"
                                        Enabled="false">

                            </R_TextBox>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_BaseCurrency"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="6">
                    <R_StackLayout Row>
                        <R_ItemLayout col="4">
                            <R_NumericTextBox @bind-Value="@_viewModel.Data.NBBASE_RATE"
                                              R_ConductorSource="_conducorAdjDetail"
                                              TValue="decimal"
                                              Enabled="false"
                                              Arrows="false">

                            </R_NumericTextBox>
                        </R_ItemLayout>
                        <R_ItemLayout col="2">
                            <R_TextBox @bind-Value="@_viewModel.Data.CCURRENCY_CODE"
                                       R_ConductorSource="_conducorAdjDetail"
                                       Enabled="false">

                            </R_TextBox>
                        </R_ItemLayout>
                        <R_ItemLayout>
                            <R_Label>=</R_Label>
                        </R_ItemLayout>
                        <R_ItemLayout col="4">
                            <R_NumericTextBox @bind-Value="@_viewModel.Data.NBCURRENCY_RATE"
                                              R_ConductorSource="_conducorAdjDetail"
                                              TValue="decimal"
                                              Enabled="false"
                                              Arrows="false">

                            </R_NumericTextBox>
                        </R_ItemLayout>
                        <R_ItemLayout col="2">
                            <R_TextBox @bind-Value="@_viewModel.Data.CBASE_CURRENCY_CODE"
                                       R_ConductorSource="_conducorAdjDetail"
                                       Enabled="false">

                            </R_TextBox>
                        </R_ItemLayout>
                    </R_StackLayout>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_Description"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="9" Class="pe-5">
                    <R_TextArea @bind-Value="@_viewModel.Data.CNOTES"
                                R_ConductorSource="_conducorAdjDetail"
                                R_EnableAdd
                                R_EnableEdit>
                    </R_TextArea>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="9">
            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_Allocation"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="2">
                    <R_TextBox @bind-Value="@_viewModel.Data.CALLOC_ID"
                               R_ConductorSource="_conducorAdjDetail"
                               OnLostFocus="@OnLostFocusAlloaction"
                               R_EnableAdd
                               R_EnableEdit>
                    </R_TextBox>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Lookup @ref="@R_Lookup_Button_Allocation"
                              R_ConductorSource="@_conducorAdjDetail"
                              R_Before_Open_Lookup="@BeforeOpenLookUp_Allocation"
                              R_After_Open_Lookup="@AfterOpenLookAllocation"
                              R_EnableAdd
                              R_EnableEdit>
                        ...
                    </R_Lookup>
                </R_ItemLayout>
                <R_ItemLayout col="6" Class="pe-1">
                    <R_TextBox @bind-Value="@_viewModel.Data.CALLOC_NAME"
                               R_ConductorSource="_conducorAdjDetail"
                               Enabled="false">
                    </R_TextBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>
    </R_StackLayout>

</R_StackLayout>
    @* Button CRUD *@
<R_StackLayout Row Class="mt-7 d-flex justify-content-between">
    <R_StackLayout Row>
        <R_ItemLayout>
            <R_AddButton R_Conductor="@_conducorAdjDetail" />
        </R_ItemLayout>

        <R_ItemLayout>
            <R_EditButton R_Conductor="@_conducorAdjDetail" />
        </R_ItemLayout>

        <R_ItemLayout>
            <R_DeleteButton R_Conductor="@_conducorAdjDetail" />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout>
            <R_Button R_Conductor="@_conducorAdjDetail"
                      Enabled="@(_viewModel.lControlCRUDMode && _viewModel.lControlButtonSubmit)"
                      OnClick="@SubmitBtn">
                @_localizer["_Submit"]
            </R_Button>
        </R_ItemLayout>
        <R_ItemLayout>
            <R_Button R_Conductor="@_conducorAdjDetail"
                      Enabled="@(_viewModel.lControlCRUDMode && _viewModel.lControlButtonRedraft)"
                      OnClick="@RedraftBtn">
                @_localizer["_Redraft"]
            </R_Button>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_StackLayout Row>
            <R_ItemLayout>
                <R_CancelButton R_Conductor="@_conducorAdjDetail" />
            </R_ItemLayout>
            <R_ItemLayout>
                <R_SaveButton R_Conductor="@_conducorAdjDetail" />
            </R_ItemLayout>
        </R_StackLayout>
    </R_StackLayout>
</R_StackLayout>

<R_Conductor @ref="_conducorAdjDetail"
             R_ViewModel="_viewModel"
             R_IsHeader="true"
             R_ServiceGetRecord="@ServiceGetRecord"
             R_ServiceSave="@ServiceSave"
             R_SetOther="@SetOtherAsync"
             R_ServiceDelete="@ServiceDelete"
             R_AfterAdd="@AfterAdd"
             R_Display="@ServiceDisplay"
             R_Validation="@R_Validation"
             R_AfterDelete="@AfterDelete"
             R_SetEdit="@R_SetEditAsync"
             R_BeforeCancel="@R_BeforeCancel"
             R_CheckEdit="@R_CheckEdit"
             R_CheckDelete="@R_CheckDelete"/>