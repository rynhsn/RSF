@page "/PMR00170"

@inherits R_Page
@inject R_ILocalizer<Resources_PMR00170_Class> _localizer
@attribute [R_Page(Title = "LOC Event", ResourceId = "_pageTitle")]

<R_StackLayout Class="ms-3">
    <R_StackLayout Row>
        <R_ItemLayout col="1">
            <R_Label>@_localizer["_labelProperty"]</R_Label>
        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_ComboBox Data="@_viewModel.PropertyList"
                        Value="_viewModel.PropertyCode"
                        ValueField="@nameof(PMR00170PropertyDTO.CPROPERTY_ID)"
                        TextField="@nameof(PMR00170PropertyDTO.CPROPERTY_NAME)"
                        R_ConductorSource="@_conductorRef" ValueChanged="@((string value)=> OnChangedProperty(value))" />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_ItemLayout>
            <hr />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_ItemLayout col="1">
            <R_Label FontColor="R_eFontColor.Danger" FontStyle="R_eFontStyle.Bold">@_localizer["_labelDepartment"]</R_Label>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="1">
            <R_Label>@_localizer["_labelFrom"]</R_Label>
        </R_ItemLayout>

        <R_ItemLayout col="1">
            <R_TextBox @bind-Value="@_viewModel.lcDeptCodeFrom"
                       R_ConductorSource="@_conductorRef"
                       OnLostFocus="OnLostFocusDeptFrom"
                       @ref="R_TextBoxBtnDeptFrom"
                       Enabled />
        </R_ItemLayout>

        <R_ItemLayout>
            <R_Lookup @ref="R_LookupBtnDeptFrom" R_Before_Open_Lookup="@Before_Open_lookupDeptFrom" R_After_Open_Lookup="@After_Open_lookupDeptFrom" Class="ms-2 me-2">...</R_Lookup>
        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_TextBox @bind-Value="@_viewModel.lcDeptNameFrom"
                       R_ConductorSource="@_conductorRef"
                       Enabled="false" />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="1">
            <R_Label>@_localizer["_labelTo"]</R_Label>
        </R_ItemLayout>

        <R_ItemLayout col="1">
            <R_TextBox @bind-Value="@_viewModel.lcDeptCodeTo"
                       R_ConductorSource="@_conductorRef"
                       OnLostFocus="OnLostFocusDeptTo"
                       @ref="R_TextBoxBtnDeptTo"
                       Enabled />
        </R_ItemLayout>

        <R_ItemLayout>
            <R_Lookup @ref="R_LookupBtnDeptTo" R_Before_Open_Lookup="@Before_Open_lookupDeptTo" R_After_Open_Lookup="@After_Open_lookupDeptTo" Class="ms-2 me-2">...</R_Lookup>
        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_TextBox @bind-Value="@_viewModel.lcDeptNameTo"
                       R_ConductorSource="@_conductorRef"
                       Enabled="false" />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_ItemLayout>
            <hr />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_ItemLayout col="1">
            <R_Label FontColor="R_eFontColor.Danger" FontStyle="R_eFontStyle.Bold">@_localizer["_labelSalesman"]</R_Label>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="1">
            <R_Label>@_localizer["_labelFrom"]</R_Label>
        </R_ItemLayout>

        <R_ItemLayout col="1">
            <R_TextBox @bind-Value="@_viewModel.lcSalesmanCodeFrom"
                       R_ConductorSource="@_conductorRef"
                       OnLostFocus="OnLostFocusSalesmanFrom"
                       @ref="R_TextBoxBtnSalesmanFrom"
                       Enabled />
        </R_ItemLayout>

        <R_ItemLayout>
            <R_Lookup @ref="R_LookupBtnSalesmanFrom" R_Before_Open_Lookup="@Before_Open_lookupSalesmanFrom" R_After_Open_Lookup="@After_Open_lookupSalesmanFrom" Class="ms-2 me-2">...</R_Lookup>
        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_TextBox @bind-Value="@_viewModel.lcSalesmanNameFrom"
                       R_ConductorSource="@_conductorRef"
                       Enabled="false" />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="1">
            <R_Label>@_localizer["_labelTo"]</R_Label>
        </R_ItemLayout>

        <R_ItemLayout col="1">
            <R_TextBox @bind-Value="@_viewModel.lcSalesmanCodeTo"
                       R_ConductorSource="@_conductorRef"
                       OnLostFocus="OnLostFocusSalesmanTo"
                       @ref="R_TextBoxBtnSalesmanTo"
                       Enabled />
        </R_ItemLayout>

        <R_ItemLayout>
            <R_Lookup @ref="R_LookupBtnSalesmanTo" R_Before_Open_Lookup="@Before_Open_lookupSalesmanTo" R_After_Open_Lookup="@After_Open_lookupSalesmanTo" Class="ms-2 me-2">...</R_Lookup>
        </R_ItemLayout>

        <R_ItemLayout col="3">
            <R_TextBox @bind-Value="@_viewModel.lcSalesmanNameTo"
                       R_ConductorSource="@_conductorRef"
                       Enabled="false" />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout>
        <R_ItemLayout>
            <hr />
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout col="3">
            <R_StackLayout>
                <R_ItemLayout col="1">
                    <R_Label FontColor="R_eFontColor.Danger" FontStyle="R_eFontStyle.Bold">@_localizer["_labelPeriod"]</R_Label>
                </R_ItemLayout>
            </R_StackLayout>

            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_labelFrom"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="4">
                    <R_NumericTextBox @bind-Value="_viewModel.lnPeriodYearFrom"
                    TValue="int"
                                      R_ConductorSource="_conductorRef"
                                      Min=_viewModel.InitialProcess.IMIN_YEAR
                                      Max=_viewModel.InitialProcess.IMAX_YEAR
                                      ThousandSeparator="false"
                                      Arrows="true" />
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_ComboBox Data="@_viewModel.GetMonthList"
                                @bind-Value="_viewModel.lcPeriodMonthFrom"
                                ValueField="@nameof(PMR00170GetMonthDTO.Id)"
                                TextField="@nameof(PMR00170GetMonthDTO.Name)"
                                R_ConductorSource="@_conductorRef"
                                PopupMaxHeight="100px">
                    </R_ComboBox>
                </R_ItemLayout>
            </R_StackLayout>


            <R_StackLayout Row>
                <R_ItemLayout col="2">
                    <R_Label>@_localizer["_labelTo"]</R_Label>
                </R_ItemLayout>
                <R_ItemLayout col="4">
                    <R_NumericTextBox @bind-Value="_viewModel.lnPeriodYearTo"
                    TValue="int"
                                      R_ConductorSource="_conductorRef"
                                      Min=_viewModel.InitialProcess.IMIN_YEAR
                                      Max=_viewModel.InitialProcess.IMAX_YEAR
                                      ThousandSeparator="false"
                                      Arrows="true" />
                </R_ItemLayout>
                <R_ItemLayout col="3">
                    <R_ComboBox Data="@_viewModel.GetMonthList"
                                @bind-Value="_viewModel.lcPeriodMonthTo"
                                ValueField="@nameof(PMR00170GetMonthDTO.Id)"
                                TextField="@nameof(PMR00170GetMonthDTO.Name)"
                                R_ConductorSource="@_conductorRef"
                                PopupMaxHeight="100px">
                    </R_ComboBox>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

        <div class="verticalLine"></div>

        <R_ItemLayout col="2" Class="ms-3">
            <R_StackLayout>
                <R_ItemLayout col="7">
                    <R_Label FontColor="R_eFontColor.Danger" FontStyle="R_eFontStyle.Bold">@_localizer["_labelReportType"]</R_Label>
                </R_ItemLayout>
            </R_StackLayout>
            <R_StackLayout Row>
                <R_ItemLayout col="7">
                    <R_RadioGroup Data="@_viewModel.GetReportTypeList"
                                  @bind-Value="_viewModel.lcReportType"
                                  ValueField="@nameof(PMR00170GetReportTypeList.Id)"
                                  TextField="@nameof(PMR00170GetReportTypeList.Name)"
                                  R_ConductorSource="@_conductorRef"
                                  Layout="R_eRadioGroupLayout.Vertical">
                    </R_RadioGroup>
                </R_ItemLayout>
            </R_StackLayout>
        </R_ItemLayout>

    </R_StackLayout>

</R_StackLayout>

<R_StackLayout>
    <R_ItemLayout>
        <hr />
    </R_ItemLayout>
</R_StackLayout>

<R_StackLayout Row="true" Class="mt-2 ms-3">
    <R_ItemLayout>
        <R_Button OnClick="OnPrint" R_Conductor="@_conductorRef">@_localizer["_labelPrint"]</R_Button>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Popup R_Before_Open_Popup="@BeforeOpen_PopupSaveAsAsync" R_After_Open_Popup="@AfterOpen_PopupSaveAsAsync" R_Conductor="@_conductorRef">@_localizer["_btn_save"]</R_Popup>
    </R_ItemLayout>
</R_StackLayout>

<R_Conductor @ref="_conductorRef"
             R_ViewModel="_viewModel"
             R_IsHeader="true" />


<style>
    .verticalLine {
        border-left: 1px solid grey;
        height: 100px;
    }
</style>
