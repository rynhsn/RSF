@page "/PMT03000"
@inherits R_Page
@attribute [R_Page(ResourceId = "_title_unitlist")]

<R_StackLayout Row>
    <R_ItemLayout col="1">
        <R_Label FontStyle="R_eFontStyle.Bold" FontColor="R_eFontColor.Danger">@_localizer["_lbl_property"]</R_Label>
    </R_ItemLayout>
    <R_ItemLayout col="3">
        <R_ComboBox Data="@_viewModel.Properties"
                    Value="@_viewModel.PropertyId"
                    ValueField="@nameof(PropertyDTO.CPROPERTY_ID)"
                    TextField="@nameof(PropertyDTO.CPROPERTY_NAME)"
                    ValueChanged="@((string value) => ComboboxProperty_ValueChangedAsync(value))">
        </R_ComboBox>
    </R_ItemLayout>
</R_StackLayout>

<R_TabStrip @ref="_tabStrip">

    <R_TabStripTab Title="@(_localizer["_title_unitlist"])" id="@nameof(PMT03000)">
        <R_StackLayout Justify="@R_eJustify.SpaceBetween" Spacing="0">

            <R_StackLayout Row>
                <R_ItemLayout col="3">
                    <R_Grid @ref="@_gridBuilding"
                            DataSource="@_viewModel.Buildings"
                            R_GridType="@R_eGridType.Original"
                            R_ConductorGridSource="@_conBuilding"
                            R_ServiceGetListRecord="@Building_GetListRecord"
                            R_Display="@Building_Display"
                            AllowAddNewRow="false"
                            AllowDeleteRow="false"
                            AllowEditRow="false"
                            Pageable
                            @bind-PageSize="@_pageSize_Building"
                            Height="540px">
                        <R_GridColumns>
                            <R_GridTextColumn FieldName="@nameof(BuildingDTO.CBUILDING_DISPLAY)" HeaderText="@(_localizer["_col_building"])" Width="200px"></R_GridTextColumn>
                        </R_GridColumns>
                    </R_Grid>
                </R_ItemLayout>
                <R_ItemLayout col="9">
                    <R_StackLayout Spacing="0">
                        <R_StackLayout>
                            <R_Grid @ref="@_gridBuildingUnit"
                                    DataSource="@_viewModel.BuildingUnits"
                                    R_GridType="@R_eGridType.Original"
                                    R_ServiceGetListRecord="@BuildingUnit_GetListRecord"
                                    R_Display="@BuildingUnit_Display"
                                    AllowAddNewRow="false"
                                    AllowDeleteRow="false"
                                    AllowEditRow="false"
                                    Pageable="true"
                                    @bind-PageSize="@_pageSize_BuildingUnit"
                                    Height="275px">
                                <R_GridColumns>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CFLOOR_NAME)" HeaderText="@(_localizer["_col_floor"])" Width="200px" Visible="@false"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CFLOOR_ID)" HeaderText="@(_localizer["_col_floor"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_NAME)" HeaderText="@(_localizer["_col_unitid"])" Width="200px" Visible="@false"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_ID)" HeaderText="@(_localizer["_col_unitid"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_TYPE_ID)" HeaderText="@(_localizer["_col_unittype"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                    <R_GridNumericColumn TValue="@decimal" FieldName="@nameof(BuildingUnitDTO.NGROSS_AREA_SIZE)" HeaderText="@(_localizer["_col_gross"])" Width="200px" Visible="@true"></R_GridNumericColumn>
                                    <R_GridNumericColumn TValue="@decimal" FieldName="@nameof(BuildingUnitDTO.NNET_AREA_SIZE)" HeaderText="@(_localizer["_col_net"])" Width="200px" Visible="@true"></R_GridNumericColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_VIEW_NAME)" HeaderText="@(_localizer["_col_unitview"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_VIEW_ID)" HeaderText="@(_localizer["_col_unitview"])" Width="200px" Visible="@false"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_CATEGORY_ID)" HeaderText="@(_localizer["_col_unitcategory"])" Width="200px" Visible="@false"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CUNIT_CATEGORY_NAME)" HeaderText="@(_localizer["_col_unitcategory"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CSTRATA_STATUS)" HeaderText="@(_localizer["_col_stratastatus"])" Width="200px" Visible="@false"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CSTRATA_STATUS_DESC)" HeaderText="@(_localizer["_col_stratastatus"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(BuildingUnitDTO.CLEASE_STATUS_DESC)" HeaderText="@(_localizer["_col_leasestatus"])" Width="200px" Visible="@true"></R_GridTextColumn>
                                </R_GridColumns>
                            </R_Grid>
                        </R_StackLayout>
                        <R_StackLayout>
                            <R_Grid @ref="@_gridTransByUnit"
                                    DataSource="@_viewModel.TransByUnits"
                                    R_GridType="@R_eGridType.Original"
                                    R_ServiceGetListRecord="@TransUnit_GetListRecord"
                                    R_Display="@TransUnit_Display"
                                    R_ConductorGridSource="@_conTransByUnit"
                                    AllowAddNewRow="false"
                                    AllowDeleteRow="false"
                                    AllowEditRow="false"
                                    Pageable="true"
                                    @bind-PageSize="@_pageSize_TrxByUnit"
                                    Height="270px">
                                <R_GridColumns>
                                    <R_GridTextColumn FieldName="@nameof(TransByUnitDTO.CTRANSACTION_NAME)" HeaderText="@(_localizer["_col_transaction"])" Width="250px"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(TransByUnitDTO.CREF_NO)" HeaderText="@(_localizer["_col_refno"])" Width="150px"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(TransByUnitDTO.CSTATUS)" HeaderText="@(_localizer["_col_trxstatus"])" Width="150px"></R_GridTextColumn>
                                    <R_GridTextColumn FieldName="@nameof(TransByUnitDTO.CTENANT_NAME)" HeaderText="@(_localizer["_col_buyerownername"])" Width="250px"></R_GridTextColumn>
                                </R_GridColumns>
                            </R_Grid>
                        </R_StackLayout>
                    </R_StackLayout>
                </R_ItemLayout>
            </R_StackLayout>

            <R_StackLayout Row Justify="@R_eJustify.FlexStart">
                <R_ItemLayout>
                    <R_Detail Enabled="@(_viewModel.TransByUnits.Count>0)"
                              R_Before_Open_Detail="@BeforeOpenPopup_MaintainMember"
                              R_After_Open_Detail="@AfterOpenDetail_MaintainMember">@_localizer["_btn_maintainmember"]</R_Detail>
                </R_ItemLayout>
                <R_ItemLayout>
                    <R_Popup Enabled="@(_viewModel.TransByUnits.Count>0)"
                             R_Before_Open_Popup="@BeforeOpenPopup_MaintainFacility"
                             R_After_Open_Popup="@AfterOpenPopup_MaintainFacility">@_localizer["_btn_maintainfacility"]</R_Popup>
                </R_ItemLayout>
            </R_StackLayout>

        </R_StackLayout>

        <R_ConductorGrid @ref="@_conBuilding"
                         R_IsHeader />
        <R_ConductorGrid @ref="@_conBuildingUnit"
                         R_ConductorParent="@_conBuilding" />
        <R_ConductorGrid @ref="@_conTransByUnit"
                         R_ConductorParent="@_conBuilding" />
    </R_TabStripTab>
</R_TabStrip>


